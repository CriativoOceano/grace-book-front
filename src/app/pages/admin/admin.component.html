<div class="admin-container">
  <div class="admin-content">
    <!-- Header -->
    <div class="page-header">
      <h1>Painel Administrativo</h1>
      <p>Gerencie reservas e conteúdo do site</p>
    </div>
    <p-tabs value="0">
      <p-tablist>
        <p-tab value="0">Todas as Reservas</p-tab>
        <p-tab value="1">Conteúdo do Site</p-tab>
        <p-tab value="2">Configurações</p-tab>
      </p-tablist>
      
      <p-tabpanels>
        <p-tabpanel value="0">
          <!-- Tabela de reservas -->
          <p-card>
          <p-table 
            [value]="reservas" 
            [loading]="isLoading"
            [paginator]="true" 
            [rows]="10"
            [showCurrentPageReport]="true"
            currentPageReportTemplate="Mostrando {first} a {last} de {totalRecords} reservas"
            [tableStyle]="{ 'min-width': '60rem' }">
            
            <ng-template #caption>
              <div class="flex items-center justify-between">
                <span class="text-xl font-bold">Reservas</span>
                <!-- <p-button icon="pi pi-refresh" rounded raised /> -->
              </div>
            </ng-template>
            
            <ng-template #header>
              <tr>
                <th>Código</th>
                <th>Cliente</th>
                <th>Tipo</th>
                <th>Data Início</th>
                <th>Data Fim</th>
                <th>Pessoas</th>
                <th>Chalés</th>
                <th>Valor Total</th>
                <th>Status</th>
                <th>Ações</th>
              </tr>
            </ng-template>
            
                        <ng-template #body let-reserva>
                          <tr>
                            <td>{{ reserva.codigo || reserva.id }}</td>
                            <td>{{ reserva.usuarioNome }}</td>
                            <td>
                              <p-tag [value]="getTipoText(reserva.tipo)" [severity]="getTipoSeverity(reserva.tipo)"></p-tag>
                            </td>
                            <td>{{ reserva.dataInicio | date:'dd/MM/yyyy' }}</td>
                            <td>{{ reserva.dataFim | date:'dd/MM/yyyy' }}</td>
                            <td>{{ reserva.quantidadePessoas }}</td>
                            <td>{{ reserva.quantidadeChales }}</td>
                            <td>{{ reserva.valorTotal | currency:'BRL':'symbol':'1.2-2':'pt' }}</td>
                            <td>
                              <p-tag [value]="getStatusText(reserva.statusReserva)" [severity]="getStatusSeverity(reserva.statusReserva)"></p-tag>
                            </td>
                            <td>
                              <div class="flex gap-2">
                                <p-button 
                                  icon="pi pi-eye" 
                                  styleClass="p-button-sm p-button-info" 
                                  (click)="viewReservationDetails(reserva)"
                                  pTooltip="Ver detalhes"
                                  tooltipPosition="top">
                                </p-button>
                                <p-button 
                                  icon="pi pi-times" 
                                  styleClass="p-button-sm p-button-danger" 
                                  (click)="cancelReservation(reserva)"
                                  pTooltip="Cancelar reserva"
                                  tooltipPosition="top"
                                  [disabled]="reserva.statusReserva === 'CANCELADA' || reserva.statusReserva === 'UTILIZADA'">
                                </p-button>
                              </div>
                            </td>
                          </tr>
                        </ng-template>
            
            <ng-template #footer>
              <tr>
                <td colspan="11">Total de {{ reservas ? reservas.length : 0 }} reservas encontradas.</td>
              </tr>
            </ng-template>
            
            <ng-template #emptymessage>
              <tr>
                <td colspan="11" class="text-center">
                  <p>As reservas aparecerão aqui quando os clientes fizerem suas solicitações.</p>
                </td>
              </tr>
            </ng-template>
          </p-table>
        </p-card>
        </p-tabpanel>

        <p-tabpanel value="1">
          <app-content-manager></app-content-manager>
        </p-tabpanel>

        <p-tabpanel value="2">
        <p-accordion value="0">
          <!-- Configuração de Preços -->
          <p-accordion-panel value="0">
            <p-accordion-header>Preços e Valores</p-accordion-header>
            <p-accordion-content>
              <app-config-precos></app-config-precos>
            </p-accordion-content>
          </p-accordion-panel>

          <!-- Configuração de Disponibilidade -->
          <p-accordion-panel value="1">
            <p-accordion-header>Disponibilidade de Datas</p-accordion-header>
            <p-accordion-content>
              <app-config-disponibilidade></app-config-disponibilidade>
            </p-accordion-content>
          </p-accordion-panel>

          <!-- Configuração de Capacidade -->
          <p-accordion-panel value="2">
            <p-accordion-header>Capacidade e Limites</p-accordion-header>
            <p-accordion-content>
              <app-config-capacidade></app-config-capacidade>
            </p-accordion-content>
          </p-accordion-panel>
        </p-accordion>
        </p-tabpanel>
      </p-tabpanels>
    </p-tabs>
  </div>
</div>

<p-toast></p-toast>